import pandas as pd
import os
import glob

# Define directories
base_directory = r"C:\Users\DELL\Documents\multiple_csv"
challenger_directory = os.path.join(base_directory, "Challenger")
cecl_directory = os.path.join(base_directory, "cecl")

# Define output file paths
challenger_output_file = os.path.join(challenger_directory, "challenger_report.xlsx")
cecl_output_file = os.path.join(cecl_directory, "cecl_report.xlsx")

def merge_csv_to_excel(csv_folder, output_file, report_name):
    """Merge all CSV files in a folder into an Excel file with multiple sheets."""
    csv_files = glob.glob(os.path.join(csv_folder, "*.csv"))

    if not csv_files:
        print(f"No CSV files found in {csv_folder}. Skipping {report_name} report creation.")
        return

    with pd.ExcelWriter(output_file, engine="xlsxwriter") as writer:
        for file in csv_files:
            # Extract the filename (without extension) for sheet name
            sheet_name = os.path.splitext(os.path.basename(file))[0][:31]  # Excel sheet name limit: 31 chars

            # Read CSV file
            df = pd.read_csv(file)

            # Write to Excel sheet
            df.to_excel(writer, sheet_name=sheet_name, index=False)

    print(f"{report_name} report created: '{output_file}' with {len(csv_files)} sheets.")

# Merge Challenger CSV files
merge_csv_to_excel(challenger_directory, challenger_output_file, "Challenger")

# Merge CECL CSV files
merge_csv_to_excel(cecl_directory, cecl_output_file, "CECL")
