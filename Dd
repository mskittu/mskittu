cat "$QUERY_FILE" | while IFS=',' read -r table_name db_name actl_tbl_name name condition; do
  # Trim spaces from variables
  table_name=$(echo "$table_name" | xargs)
  db_name=$(echo "$db_name" | xargs)
  actl_tbl_name=$(echo "$actl_tbl_name" | xargs)
  condition=$(echo "$condition" | xargs)

  # Check for valid inputs
  if [[ -z "$table_name" || -z "$db_name" || -z "$actl_tbl_name" || -z "$condition" ]]; then
    echo "Skipping invalid line: $table_name, $db_name, $actl_tbl_name, $condition"
    continue
  fi

  # Fix TO_DATE condition: Replace single dates with correct TO_DATE formatting
  # Ensure no extra wrapping of TO_DATE and remove redundant operations
  condition=$(echo "$condition" | sed -E "s/TO_DATE([0-9]{8}), 'yyyymmdd'/TO_DATE(\1, 'yyyymmdd')/g")

  # Construct the SQL query
  sql_query="SELECT COUNT(*) FROM $db_name.$actl_tbl_name WHERE $condition"

  # Log the query being executed
  echo "Executing query for table $table_name in database $db_name: $sql_query"

  # Execute the query using sqlplus and capture the result
  row_count=$(sqlplus -s /nolog <<EOF
  CONNECT ${USERNAME}/${PASSWORD}@${HOST}:${PORT}/${DB}
  SET FEEDBACK OFF
  SET HEADING OFF
  SET PAGESIZE 0
  SET TRIMSPOOL ON

  $sql_query
EOF
  )

  echo "Row count: $row_count"
done
